<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.BAuditMapper">
    
    <resultMap type="BAudit" id="BAuditResult">
        <result property="id"    column="id"    />
        <result property="patrolId"    column="patrol_id"    />
        <result property="auditUser"    column="audit_user"    />
        <result property="auditOpinion"    column="audit_opinion"    />
        <result property="auditStatus"    column="audit_status"    />
        <result property="currentDept"    column="current_dept"    />
        <result property="subordinateDept"    column="subordinate_dept"    />
        <result property="dataState"    column="data_state"    />
        <result property="freedom1"    column="freedom1"    />
        <result property="freedom2"    column="freedom2"    />
        <result property="freedom3"    column="freedom3"    />
        <result property="freedom4"    column="freedom4"    />
        <result property="freedom5"    column="freedom5"    />

        <result property="uptime"    column="uptime"    />
        <result property="project_name"    column="project_name"    />
        <result property="unit_name"    column="unit_name"    />
        <result property="inspector_name"    column="inspector_name"    />
        <result property="phone"    column="phone"    />
        <result property="patrol_type"    column="patrol_type"    />
    </resultMap>

    <sql id="selectBAuditVo">
        select a.id, a.patrol_id,b.patrol_type, b.freedom2 uptime, d.project_name,c.unit_name,b1.inspector_name,b1.phone,
        a.audit_user, a.audit_opinion, a.audit_status, a.current_dept,
        a.subordinate_dept, a.data_state, a.freedom1, a.freedom2, a.freedom3, a.freedom4, a.freedom5
        from b_audit a
        left join b_patrol b on a.patrol_id=b.id
        left join b_inspector b1 on b.inspector_id =b1.id
        left join b_patrol_unit c on b.patrol_unit=c.id
        left join b_project d on c.project_id =d.id
    </sql>

    <select id="selectBAuditList" parameterType="BAudit" resultMap="BAuditResult">
        <include refid="selectBAuditVo"/>
        <where>  
            <if test="patrolId != null "> and patrol_id = #{patrolId}</if>
            <if test="auditUser != null "> and audit_user = #{auditUser}</if>
            <if test="auditOpinion != null  and auditOpinion != ''"> and audit_opinion = #{auditOpinion}</if>
            <if test="auditStatus != null "> and audit_status = #{auditStatus}</if>
            <if test="currentDept != null "> and current_dept = #{currentDept}</if>
            <if test="subordinateDept != null "> and subordinate_dept = #{subordinateDept}</if>
            <if test="dataState != null "> and data_state = #{dataState}</if>
            <if test="freedom1 != null  and freedom1 != ''"> and freedom1 = #{freedom1}</if>
            <if test="freedom2 != null  and freedom2 != ''"> and freedom2 = #{freedom2}</if>
            <if test="freedom3 != null  and freedom3 != ''"> and freedom3 = #{freedom3}</if>
            <if test="freedom4 != null  and freedom4 != ''"> and freedom4 = #{freedom4}</if>
            <if test="freedom5 != null  and freedom5 != ''"> and freedom5 = #{freedom5}</if>
        </where>
    </select>
    
    <select id="selectBAuditById" parameterType="Long" resultMap="BAuditResult">
        <include refid="selectBAuditVo"/>
        where a.id = #{id}
    </select>
        
    <insert id="insertBAudit" parameterType="BAudit" useGeneratedKeys="true" keyProperty="id">
        insert into b_audit
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="patrolId != null">patrol_id,</if>
            <if test="auditUser != null">audit_user,</if>
            <if test="auditOpinion != null">audit_opinion,</if>
            <if test="auditStatus != null">audit_status,</if>
            <if test="currentDept != null">current_dept,</if>
            <if test="subordinateDept != null">subordinate_dept,</if>
            <if test="dataState != null">data_state,</if>
            <if test="freedom1 != null">freedom1,</if>
            <if test="freedom2 != null">freedom2,</if>
            <if test="freedom3 != null">freedom3,</if>
            <if test="freedom4 != null">freedom4,</if>
            <if test="freedom5 != null">freedom5,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="patrolId != null">#{patrolId},</if>
            <if test="auditUser != null">#{auditUser},</if>
            <if test="auditOpinion != null">#{auditOpinion},</if>
            <if test="auditStatus != null">#{auditStatus},</if>
            <if test="currentDept != null">#{currentDept},</if>
            <if test="subordinateDept != null">#{subordinateDept},</if>
            <if test="dataState != null">#{dataState},</if>
            <if test="freedom1 != null">#{freedom1},</if>
            <if test="freedom2 != null">#{freedom2},</if>
            <if test="freedom3 != null">#{freedom3},</if>
            <if test="freedom4 != null">#{freedom4},</if>
            <if test="freedom5 != null">#{freedom5},</if>
         </trim>
    </insert>

    <update id="updateBAudit" parameterType="BAudit">
        update b_audit
        <trim prefix="SET" suffixOverrides=",">
            <if test="patrolId != null">patrol_id = #{patrolId},</if>
            <if test="auditUser != null">audit_user = #{auditUser},</if>
            <if test="auditOpinion != null">audit_opinion = #{auditOpinion},</if>
            <if test="auditStatus != null">audit_status = #{auditStatus},</if>
            <if test="currentDept != null">current_dept = #{currentDept},</if>
            <if test="subordinateDept != null">subordinate_dept = #{subordinateDept},</if>
            <if test="dataState != null">data_state = #{dataState},</if>
            <if test="freedom1 != null">freedom1 = #{freedom1},</if>
            <if test="freedom2 != null">freedom2 = #{freedom2},</if>
            <if test="freedom3 != null">freedom3 = #{freedom3},</if>
            <if test="freedom4 != null">freedom4 = #{freedom4},</if>
            <if test="freedom5 != null">freedom5 = #{freedom5},</if>
        </trim>
        where id = #{id}
    </update>

    <delete id="deleteBAuditById" parameterType="Long">
        delete from b_audit where id = #{id}
    </delete>

    <delete id="deleteBAuditByIds" parameterType="String">
        delete from b_audit where id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
</mapper>